---
title: React å­¦ä¹ ç¬”è®°
date: 2021-06-05 00:00:00
sidebar: auto
sticky: false
permalink: /pages/react210605/
categories: 
  - æ¡†æ¶
tags: 
  - react
---
<p align="center">
  <img width="500" src="https://p15.qhimg.com/dmfd/2560_1440_/t01bc6918e95330e098.jpg"/>
</p>
>  React åŸºç¡€æ€»ç»“

<!-- more -->

## åŸºç¡€

#### æ¡†æ¶å®šä¹‰

æ˜¯ä¸€ä¸ªå°†æ•°æ®æ¸²æŸ“ä¸ºHTMLè§†å›¾çš„å¼€æº javascript åº“

- reactç‰¹ç‚¹

  - ç»„ä»¶åŒ–ã€å£°æ˜å¼ç¼–ç ï¼Œæé«˜å¼€å‘æ•ˆç‡
  - è™šæ‹ŸDOM + ä¼˜ç§€Diffingç®—æ³•
  - åœ¨React Nativeä¸­ä½¿ç”¨Reactè¯­æ³•è¿›è¡Œç§»åŠ¨ç«¯å¼€å‘
- è™šæ‹ŸDOM

  - æœ¬è´¨æ˜¯Objectç±»å‹çš„å¯¹è±¡
  - è™šæ‹ŸDOMæ¯”è¾ƒâ€œè½»â€ï¼ŒçœŸå®DOMæ¯”è¾ƒé‡
  - è™šæ‹ŸDOMæœ€ç»ˆä¼šè¢«è½¬åŒ–ä¸ºçœŸå®DOMï¼Œå‘ˆç°åœ¨é¡µé¢
- jsxè¯­æ³•è§„åˆ™

  - å®šä¹‰è™šæ‹ŸDOMæ—¶ï¼Œä¸è¦å†™å¼•å·
  - æ··å…¥jsè¡¨è¾¾å¼è¦ç”¨
  - ç±»å className
  - å†…è”æ ·å¼
  - åªæœ‰ä¸€ä¸ªæ ¹æ ‡ç­¾
  - æ ‡ç­¾å¿…é¡»é—­åˆ
  - æ ‡ç­¾é¦–å­—æ¯
    - å°å†™ï¼ˆæ‰¾å¯¹åº”htmlä¸­åŒåå…ƒç´ ï¼‰
    - å¤§å†™ï¼ˆæ‰¾å¯¹åº”ç»„ä»¶ï¼‰

#### å‡†å¤‡å·¥ä½œ

```javascript
<body>
    <script type="text/javascript" src="js/react.development.js"></script> // å¼•å…¥React
    <script type="text/javascript" src="js/react-dom.development.js"></script> // å¼•å…¥ReactDOM
    <script type="text/javascript" src="js/babel.min.js"></script> // å¼•å…¥babel,å°†jsxè½¬ä¸ºjs
    <script type="text/javascript" src="js/prop-types.js"></script> // å¼•å…¥prop-types,ç”¨äºå¯¹ç»„ä»¶æ ‡ç­¾è¿›è¡Œé™åˆ¶
</body>  
```

#### è¡¨è¾¾å¼ `vs`è¯­å¥

```javascript
/*
        ä¸€å®šæ³¨æ„åŒºåˆ†ï¼šã€jsè¯­å¥(ä»£ç )ã€‘ä¸ã€jsè¡¨è¾¾å¼ã€‘
                1.è¡¨è¾¾å¼ï¼šä¸€ä¸ªè¡¨è¾¾å¼ä¼šäº§ç”Ÿä¸€ä¸ªå€¼ï¼Œå¯ä»¥æ”¾åœ¨ä»»ä½•ä¸€ä¸ªéœ€è¦å€¼çš„åœ°æ–¹
                            ä¸‹é¢è¿™äº›éƒ½æ˜¯è¡¨è¾¾å¼ï¼š
                                    (1). a
                                    (2). a+b
                                    (3). demo(1)
                                    (4). arr.map()
                                    (5). function test () {}
                2.è¯­å¥(ä»£ç )ï¼š
                            ä¸‹é¢è¿™äº›éƒ½æ˜¯è¯­å¥(ä»£ç )ï¼š
                                    (1).if(){}
                                    (2).for(){}
                                    (3).switch(){case:xxxx}

 */
```

#### å”¯ä¸€keyå€¼

> å› ä¸º `{}`è¦å†™è¡¨è¾¾å¼ï¼Œæ‰€ä»¥è¦ä½¿ç”¨`arr.map`éå†

#### åˆ›å»ºå‡½æ•°å¼ç»„ä»¶

```javascript
<script type="text/babel">
    function MyComponent() {
    	return <h2>è‡ªå®šä¹‰ç»„ä»¶</h2>
	}
	ReactDom.reader(<MyComponent/>, document.getElementById('test'))
</script>    
```

#### åˆ›å»ºç±»å¼ç»„ä»¶

```javascript
<script type="text/babel">
    class MyComponent extends React.Component {
        render() {
            return <h2>è‡ªå®šä¹‰ç»„ä»¶</h2>
        }
    }
	ReactDom.render(<MyComponent/>, document.getElementById('test'))
</script>   
```

#### ç»„ä»¶å®ä¾‹æ ¸å¿ƒå±æ€§State

```javascript
<script type="text/babel">
    class Weather extends React.Component {
        constructor(props) {
            super(props)
            this.state = { isHot: false, wind: 'å¾®é£' }  // ç¬¬ä¸€å°è±¡ï¼Œå¯ä¼˜åŒ–
            this.changeWeather = this.changeWeather.bind(this) // æ”¹å˜åŸå‹æ–¹æ³•ä¸ŠthisæŒ‡å‘åŒæ—¶èµ‹å€¼ç»™this.changeWeatheræ–¹æ³•ï¼Œå¯ä¼˜åŒ–
        }
        render() {
            const { isHot, wind } = this.state
            return <h1 onClick={this.changeWeather}>ä»Šå¤©å¤©æ°”å¾ˆ{ isHot ? 'ç‚çƒ­' : 'å‡‰çˆ½' }, { wind }<h1/>
        }
        changeWeather() {
            const isHot = this.state.isHot
            this.setState({ isHot: !isHot })  // æ­£ç¡®å†™æ³•
            // this.state.isHot = !isHot //é”™è¯¯å†™æ³•
        }    
    }
    ReactDOM.render(<Weather/>, document.getElementById('test'))    
</script>  
```

#### ä¸¤ä¸ªå°æŠ€å·§

```javascript
<script type="text/javascript" >
    // ç±»ä¸­å¯ä»¥ç›´æ¥å†™èµ‹å€¼è¯­å¥ï¼Œå¦‚ä¸‹ä»£ç å«ä¹‰ï¼š ç»™carçš„å®ä¾‹å¯¹è±¡æ·»åŠ ä¸€ä¸ªå±æ€§ï¼Œåä¸ºa, å€¼ä¸º1
    // è‡ªå®šä¹‰æ–¹æ³•â€”â€”è¦ç”¨èµ‹å€¼è¯­å¥çš„å½¢å¼ + ç®­å¤´å‡½æ•°ï¼Œæ•…æ­¤å¯¼è‡´thisæŒ‡å‘ç±»
    class Car {
        constructor(name, price) {
            this.name = name
            this.price = price
            // this.wheel = 4
        }
        a = 1
        wheel = 4
        static demo = 100
    }
</script>    
```



#### stateç®€å†™æ ¼å¼

```javascript
<script type="text/babel">
	// åˆ›å»ºç»„ä»¶
    class Weather extends React.Component {
        state = { isHot: false, wind: 'å¾®é£' } // ä¼˜åŒ–ä¸€
        render() {
            const { isHot, wind } = this.state
            return <h1 onClick={ this.changeWeather }>ä»Šå¤©å¤©æ°”å¾ˆ{isHot ? 'ç‚çƒ­' : 'å‡‰çˆ½'}, { wind }</h1>
        }
        // è‡ªå®šä¹‰æ–¹æ³•â€”â€”è¦ç”¨èµ‹å€¼è¯­å¥çš„å½¢å¼ + ç®­å¤´å‡½æ•°
        changeWeather = () => { // ä¼˜åŒ–äºŒ
            const isHot = this.state.isHot
            this.setState({ isHot: !isHot })
        }
    }
	// æ¸²æŸ“ç»„ä»¶åˆ°é¡µé¢
	ReactDOM.render(<weather/>, document.getElementById('test'))
</script>  
```

#### propsåŸºæœ¬ä½¿ç”¨

```javascript
<script type="text/babel">
	// åˆ›å»ºç»„ä»¶
    class Person extends React.Component {
        render() {
            const { name, age, sex } = this.props
            return (
            	<ul>
                	<li>å§“åï¼š{ name }</li>
                	<li>æ€§åˆ«ï¼š{ sex }</li>
                	<li>å¹´é¾„ï¼š{ age + 1 }</li>
                </ul>
            )
        }
    }
    // æ¸²æŸ“ç»„ä»¶åˆ°é¡µé¢
    ReactDom.render(<Person name="jerry" age={19} sex="ç”·"/>, document.getElementById(test1))
    ReactDom.render(<Person name="tom" age={18} sex="å¥³"/>, document.getElementById(test2))
    const p = {name: 'è€åˆ˜', age: 18, sex: 'å¥³'}
    // ReactDom.render(<Person name={p.name} age={p.age} sex={p.sex}/>, document.getElementById(test3))
    ReactDom.render(<Person {...p}/>, document.getElementById('test3'))
</script>   
```

#### å±•å¼€è¿ç®—ç¬¦...ç»ƒä¹ 

- å±•å¼€è¿ç®—ç¬¦ä¸èƒ½å±•å¼€å¯¹è±¡ï¼ŒæŠ¥é”™

- `{...person} `  ä¸ºæµ…æ‹·è´æ“ä½œ

- åˆå¹¶ä¿®æ”¹

  ```javascript
  let person = { name: 'tom', age: 12 }
  let person2 = {...person, name: 'jack', address: 'åœ°çƒ'}
  ```

#### propsç±»å‹é™åˆ¶  

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Person extends React.Component{
        render() {
            const { name, age, sex } = this.props // propsåªè¯»
            return (
            	<ul>
                	<li>å§“åï¼š{ name }</li>
                	<li>æ€§åˆ«ï¼š{ sex }</li>
                	<li>å¹´é¾„ï¼š{ age + 1 }</li>
                </ul>
            )
        }
    }
    Person.propTypes = {
        name: PropTypes.string.isRequired, //é™åˆ¶nameå¿…ä¼ ï¼Œä¸”ä¸ºå­—ç¬¦ä¸²
        sex: PropTypes,string, // é™åˆ¶sexä¸ºå­—ç¬¦ä¸²
        age: PropTypes.number, // é™åˆ¶ageä¸ºæ•°å€¼
        speak: PropTypes.func // é™åˆ¶speakä¸ºå‡½æ•°ï¼Œå› ä¸ºfunctionä¸ºå…³é”®å­—ï¼Œæ‰€ä»¥æ›´æ”¹ä¸ºfunc
    }
	Person.defaultProps = {
        sex: 'ç”·', // sexé»˜è®¤å€¼ä¸ºç”·
        age: 18 // ageé»˜è®¤å€¼ä¸º18
    }
	// æ¸²æŸ“ç»„ä»¶åˆ°é¡µé¢
    ReactDom.render(<Person name="jerry" age={19} sex="ç”·"/>, document.getElementById(test1))
    ReactDom.render(<Person name="tom" age={18} sex="å¥³"/>, document.getElementById(test2))
    const p = {name: 'è€åˆ˜', age: 18, sex: 'å¥³'}
    // ReactDom.render(<Person name={p.name} age={p.age} sex={p.sex}/>, document.getElementById(test3))
    ReactDom.render(<Person {...p}/>, document.getElementById('test3'))
</script>   
```

#### propsç®€å†™å½¢å¼

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Person extends React.Component {
        constructor(props) {
            super(props) // æ„é€ å™¨æ˜¯å¦æ¥æ”¶props,æ˜¯å¦ä¼ é€’ç»™super, å–å†³äºï¼š æ˜¯å¦å¸Œæœ›åœ¨æ„é€ å™¨ä¸­é€šè¿‡thisè®¿é—®props
        }
        static propTypes = {
            name: PropTypes.string.isRequired,
            sex: PropTypes.string,
            age: PropTypes.number
        }
        static defaultProps = {
            sex: 'ç”·',
            age: 18
        }
        render() {
            const { name, age, sex } = this.props // propsåªè¯»
            return (
            	<ul>
                	<li>å§“åï¼š{ name }</li>
                	<li>æ€§åˆ«ï¼š{ sex }</li>
                	<li>å¹´é¾„ï¼š{ age + 1 }</li>
                </ul>
            )
        }
    }
    // æ¸²æŸ“çµ„ä»¶åˆ°é é¢
    ReactDOM.render(<Person name="jerry"/>, document.getElementById('test'))
</script>   
```

#### å‡½æ•°å¼ç»„ä»¶ä½¿ç”¨props

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    function Person(props) {
    	const { name, age, sex } = props
        return (
            <ul>
                <li>å§“åï¼š{ name }</li>
                <li>æ€§åˆ«ï¼š{ sex }</li>
                <li>å¹´é¾„ï¼š{ age + 1 }</li>
            </ul>
        )
	}
    Person.propTypes = {
        name: PropTypes.string.isRequired,
        sex: PropTypes.string,
        age: PropTypes.number
    }
	Person.defaultProps = {
        sex: 'ç”·'ï¼Œ
        age: 18
    }
	// æ¸²æŸ“çµ„ä»¶åˆ°é é¢
    ReactDOM.render(<Person name="jerry"/>, document.getElementById('test'))
</script>   
```

#### å­—ç¬¦ä¸²å½¢å¼çš„refs

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Demo extends React.Component {
        showData = () => {
            const { input1 } = this.refs
        }
    }
	render() {
        return (
        	<input ref="input1" type="text" placeholder="ç‚¹å‡»æŒ‰é’®æç¤ºæ•°æ®"/>
        )
    }
	// æ¸²æŸ“ç»„ä»¶
	ReactDOM.render(<Demo a="1" b="2"/>, document.getElementById('test'))
</script>   
```

#### å›è°ƒå‡½æ•°å½¢å¼çš„refs

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Demo extends React.Component {
        showData = () => {
            const { input1 } = this
        }
    }
	render() {
        return (
        	<input ref="{ c => this.input1 = c }" type="text" placeholder="ç‚¹å‡»æŒ‰é’®æç¤ºæ•°æ®"/>
        )
    }
	// æ¸²æŸ“ç»„ä»¶
	ReactDOM.render(<Demo a="1" b="2"/>, document.getElementById('test'))
</script>   
```

#### å›è°ƒå‡½æ•°refsçš„è¯´æ˜

> å¦‚æœrefå›è°ƒå‡½æ•°æ˜¯ä»¥å†…è”å‡½æ•°æ–¹å¼å®šä¹‰çš„ï¼Œåœ¨æ›´æ–°è¿‡ç¨‹ä¸­ä¼šè¢«æ‰§è¡Œ**ä¸¤æ¬¡**ï¼Œç¬¬ä¸€å‚æ•°ä¸ºnullï¼Œç¬¬äºŒæ¬¡ä¼šä¼ å…¥å‚æ•°DOMå…ƒç´ ï¼ˆå½“å‰èŠ‚ç‚¹ï¼‰

> è§£å†³ï¼š é€šè¿‡refçš„å›è°ƒå‡½æ•°å®šä¹‰æˆcalssçš„ç»‘å®šå‡½æ•°çš„æ–¹å¼å¯ä»¥é¿å…

> å®ƒæ˜¯æ— å…³ç´§è¦çš„

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Demo extends React.Component {
        showData = () => {
            const { input1 } = this
        }
    }
	// React.createRefè°ƒç”¨åå¯ä»¥è¿”å›ä¸€ä¸ªå®¹å™¨ï¼Œè¯¥å®¹å™¨å¯ä»¥å­˜å‚¨refæ‰€æ ‡è¯†çš„èŠ‚ç‚¹ï¼Œè¯¥å®¹å™¨æ˜¯â€œä¸“äººä¸“ç”¨â€
	myRef = React.createRef()
	render() {
        return (
            <div>
            	<input ref={this.myRef} type="text" placeholder="ç‚¹å‡»æŒ‰é’®æç¤ºæ•°æ®"/>
            <div/>
        )
    }
	// æ¸²æŸ“ç»„ä»¶
	ReactDOM.render(<Demo a="1" b="2"/>, document.getElementById('test'))
</script> 
```

#### äº‹ä»¶å¤„ç†

- é€šè¿‡onXxxå±æ€§æŒ‡å®šäº‹ä»¶å¤„ç†å‡½æ•°ï¼ˆæ³¨æ„å¤§å°å†™ï¼‰
  - Reactä½¿ç”¨çš„æ˜¯è‡ªå®šä¹‰ï¼ˆåˆæˆï¼‰äº‹ä»¶ï¼Œè€Œä¸æ˜¯ä½¿ç”¨åŸç”ŸDOMäº‹ä»¶ â€”â€”ä¸ºäº†æ›´å¥½çš„å…¼å®¹æ€§
  - Reactä¸­çš„äº‹ä»¶æ˜¯é€šè¿‡äº‹ä»¶å§”æ‰˜æ–¹å¼å¤„ç†çš„ï¼ˆå§”æ‰˜ç»„ä»¶æœ€å¤–å±‚çš„å…ƒç´ ï¼‰â€”â€”ä¸ºäº†é«˜æ•ˆ
- é€šè¿‡`event.targer`å¾—åˆ°å‘ç”Ÿäº‹ä»¶çš„DOMå…ƒç´ å¯¹è±¡â€”â€”ä¸è¦è¿‡åº¦ä½¿ç”¨ref

```javascript
<script type="text/babel">
    //åˆ›å»ºç»„ä»¶
    class Demo extends React.Component{
        //åˆ›å»ºrefå®¹å™¨
        myRef = React.createRef()
        myRef2 = React.createRef()

        //å±•ç¤ºå·¦ä¾§è¾“å…¥æ¡†çš„æ•°æ®ï¼Œå› ä¸ºè·å–çš„ä¸æ˜¯æœ¬èº«ä¸Šçš„å±æ€§ï¼Œæ‰€æœ‰éœ€å€ŸåŠ©refå®ç°
        showData = (event)=>{
            console.log(event.target);
            alert(this.myRef.current.value);
        }

        //å±•ç¤ºå³ä¾§è¾“å…¥æ¡†çš„æ•°æ®, å¯ä»¥ä¸ä½¿ç”¨ref
        showData2 = (event)=>{
            alert(event.target.value);
        }

        render(){
            return(
                <div>
                    <input ref={this.myRef} type="text" placeholder="ç‚¹å‡»æŒ‰é’®æç¤ºæ•°æ®"/>&nbsp;
                    <button onClick={this.showData}>ç‚¹æˆ‘æç¤ºå·¦ä¾§çš„æ•°æ®</button>&nbsp;
            		<input onBlur={this.showData2} type="text" placeholder="å¤±å»ç„¦ç‚¹æç¤ºæ•°æ®"/>&nbsp;
            	</div>
			)
		}
    }
    //æ¸²æŸ“ç»„ä»¶åˆ°é¡µé¢
    ReactDOM.render(<Demo a="1" b="2"/>,document.getElementById('test'))
</script>
```

#### éå—æ§ç»„ä»¶ï¼ˆç›¸å½“äºvueä¸­çš„ v-bindï¼‰

```javascript
<script type="text/babel">
	//åˆ›å»ºç»„ä»¶
	class Login extends React.Component{
        render() {
            return (
            	<form onSubmit={this.handleSubmit}>
                	ç”¨æˆ·åï¼š<input ref={ c => this.username = c } type="text" name="username"/>
                    å¯†ç ï¼š<input ref={ c => this.password = c } type="password" name="password"/>   
                <from/>
            )
        }
        handleSubmit = (event) => {
            event.preventDefault() //é˜»æ­¢è¡¨å•æäº¤
            const { username, password } = this
            alert(`ä½ è¾“å…¥çš„ç”¨æˆ·åæ˜¯ï¼š${username.value},ä½ è¾“å…¥çš„å¯†ç æ˜¯ï¼š${password.value}`)
        }
    }
	//æ¸²æŸ“ç»„ä»¶
	ReactDom.render(<login/>, document.getElementId('test'))
</script>
```

#### å—æ§ç»„ä»¶

> éšç€ä½ çš„è¾“å…¥ï¼Œä¸æ–­ç»´æŠ¤çŠ¶æ€ï¼ˆstateï¼‰

> çœç•¥ref

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Login extends React.Component{
        state = {
            username: '',
            password: ''
        }
        savePassword = (event) => {
            this.setState({username:event.target.value})
        }
        savePassword = (event) => {
            this.setState({password:event.target.value})
        }
        handleSubmit = (event) => {
            event.preventDefault()
            const {username,password} = this.state
            alert(`ä½ è¾“å…¥çš„ç”¨æˆ·åæ˜¯ï¼š${username},ä½ è¾“å…¥çš„å¯†ç æ˜¯ï¼š${password}`)
        }
        render() {
            <form onSubmit={this.handleSubmit}>
                ç”¨æˆ·åï¼š<input onChange={this.saveUsername} type="text" name="username"/>
                å¯†ç ï¼š<input onChange={this.savePassword} type="passwod" name="password"/>
                <button>ç™»é™†</button>    
            </form>    
        }
    }
    // æ¸²æŸ“ç»„ä»¶
	ReactDOM.render(<Login/>,document.getElementById('test'))
</script>
```

#### é«˜é˜¶å‡½æ•°/æŸ¯é‡ŒåŒ–

- é«˜é˜¶å‡½æ•°ï¼ˆç¬¦åˆä»¥ä¸‹å…¶ä¸­ä¸€ä¸ªï¼Œå°±æ˜¯é«˜é˜¶ï¼‰

  - Aå‡½æ•°ï¼Œæ¥å—çš„å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°
  - Aå‡½æ•°ï¼Œè¿”å›å€¼ä¾ç„¶æ˜¯ä¸ªå‡½æ•°

  > Promiseã€setTimeoutã€arr.map()ã€arr.filter()ç­‰ç­‰

- æŸ¯é‡ŒåŒ–

  ```javascript
  // æ­£å¸¸å†™æ³•
  function sum(a,b,c){
      return a + b + c
  }
  // æŸ¯é‡ŒåŒ–
  function sum(a) {
      return (b)=>{
          return (c)=>{
              return a+b+c
          }
      }
  }
  const result = sum(1)(2)(3)
  ```

  ![img](https://staticqn.qizuang.com/custom/20220505/Fm2P2CgbEF219tBsm863ot1iSiHH)

  ```javascript
  <script type="text/babel">
      // åˆ›å»ºç»„ä»¶
      class Login extends React.Component{
          state = {
              username: '',
              password: ''
          }
          saveFormData = (dataType) => {
              return (event)=>{
                  this.setState({[dataType]: event.target.value})
              }
          }
          //è¡¨å•æäº¤çš„å›è°ƒ
          handleSubmit = (event)=>{
              event.preventDefault() //é˜»æ­¢è¡¨å•æäº¤
              const {username,password} = this.state
              alert(`ä½ è¾“å…¥çš„ç”¨æˆ·åæ˜¯ï¼š${username},ä½ è¾“å…¥çš„å¯†ç æ˜¯ï¼š${password}`)
          }
          render() {
              return(
              	<form onSubmit = {this.handleSubmit}>
                  	ç”¨æˆ·åï¼š<input onChange={this.saveFormData('username')} type="text" name="username"/>
                      å¯†ç ï¼š<input onChange={this.saveFormData('password')} type="password" name="password"/>
                      <button>ç™»é™†</button>    
                  </form>
              )
          }
      }
      // æ¸²æŸ“ç»„ä»¶
  </script>    
  ```


#### ä¸ä½¿ç”¨æŸ¯é‡ŒåŒ–

```javascript
<script type="text/babel">
	//åˆ›å»ºç»„ä»¶
	class Login extends React.Component{
		//åˆå§‹åŒ–çŠ¶æ€
		state = {
			username:'', //ç”¨æˆ·å
			password:'' //å¯†ç 
		}

		//ä¿å­˜è¡¨å•æ•°æ®åˆ°çŠ¶æ€ä¸­
		saveFormData = (dataType,event)=>{
			this.setState({[dataType]:event.target.value})
		}

		//è¡¨å•æäº¤çš„å›è°ƒ
		handleSubmit = (event)=>{
			event.preventDefault() //é˜»æ­¢è¡¨å•æäº¤
			const {username,password} = this.state
			alert(`ä½ è¾“å…¥çš„ç”¨æˆ·åæ˜¯ï¼š${username},ä½ è¾“å…¥çš„å¯†ç æ˜¯ï¼š${password}`)
		}
		render(){
			return(
				<form onSubmit={this.handleSubmit}>
					ç”¨æˆ·åï¼š<input onChange={event => this.saveFormData('username', event)} type="text" name="username"/>
					å¯†ç ï¼š<input onChange={event => this.saveFormData('password', event)} type="password" name="password"/>
					<button>ç™»å½•</button>
				</form>
			)
		}
	}
	//æ¸²æŸ“ç»„ä»¶
	ReactDOM.render(<Login/>,document.getElementById('test'))
</script>
```

#### ç”Ÿå‘½å‘¨æœŸ

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Life extends React.Component {
        state = { opacity: 1 }
        death = ()=>{
            ReactDOM.ummountComponentAtNode(document.getElementById('test'))
        }
        // ç»„ä»¶æŒ‚è½½å®Œæ¯•
        componentDidMount() {
            this.timer = setInterval(()=>{
                let {opacity} = this.state
                opacity -= 0.1
                if(opacity <= 0) opacity = 1
                this.setState({opacity})
            },200)
        }
        componentWillUnmount(){
            clearInterval(this.timer)
        }
        render(){
            return (
            	<div>
                	<h2 style={{opacity: this.state.opacity}}>æˆ‘çˆ±èŒƒå†°å†°</h2>
                    <button onClick={this.death}>ä¸æ´»äº†</button>
                </div>
            )
        }
    }
    // æ¸²æŸ“ç»„ä»¶
    ReactDOm.render(<Life/>, document.getElementById('test'))
</script> 
```

#### reactç”Ÿå‘½å‘¨æœŸï¼ˆæ—§ï¼‰

1. åˆå§‹åŒ–é˜¶æ®µ

   - constructor()

   - componentWillMount()

   - render()

   - componentDidMound()    å¸¸ç”¨

     ä¸€èˆ¬åœ¨è¿™ä¸ªé’©å­ä¸­åšä¸€äº›åˆå§‹åŒ–çš„äº‹ï¼Œä¾‹å¦‚ï¼š å¼€å¯å®šæ—¶å™¨ï¼Œå‘é€ç½‘ç»œè¯·æ±‚ï¼Œè®¢é˜…æ¶ˆæ¯

2. æ›´æ–°é˜¶æ®µ

   > ç”±ç»„ä»¶å†…éƒ¨`this.setSate`æˆ–çˆ¶ç»„ä»¶renderè§¦å‘

   - shouldComponentUpdate()
   - componentWillUpdate()
   - render()
   - componentDidUpdate()

3. å¸è½½ç»„ä»¶

   > ç”±ReactDOM.unmountComponentAtNode() è§¦å‘

   - componentWillUnmount()  å¸¸ç”¨

     ä¸€èˆ¬åœ¨è¿™ä¸ªé’©å­åšä¸€äº›æ”¶å°¾çš„äº‹ï¼Œä¾‹å¦‚ï¼š å…³é—­å®šæ—¶å™¨ï¼Œå–æ¶ˆè®¢é˜…æ¶ˆæ¯

#### reactç”Ÿå‘½å‘¨æœŸï¼ˆæ–°ï¼‰

1. åˆå§‹åŒ–é˜¶æ®µ

   - constructor()

   - getDerivedStateFromProps

     > å­—é¢è®°å¿†: å³stateçš„å€¼åœ¨**ä»»ä½•æ—¶å€™**éƒ½å–å†³äºprops
     >
     > get(è·å–) -   Derived(å…¨éƒ¨æ¥æº) - State - From-Props

   - render()

   - componentDidMount()

2. æ›´æ–°é˜¶æ®µ

   - getDerivedStateFromProps

   - shouldComponentUpdate()

   - render()

   - getSnapshotBeforeUpdate

     > snapshot: å¿«ç…§
     >
     > åœ¨æœ€è¿‘ä¸€æ¬¡æ¸²æŸ“è¾“å‡ºï¼ˆæäº¤åˆ°DOMèŠ‚ç‚¹ï¼‰ä¹‹å‰è°ƒç”¨ã€‚å®ƒä½¿å¾—ç»„ä»¶èƒ½åœ¨å‘ç”Ÿæ”¹å˜ä¹‹å‰ä»DOMä¸­æ•è·ä¸€äº›ä¿¡æ¯ï¼ˆä¾‹å¦‚.æ»šåŠ¨ä½ç½®ï¼‰

   - componentDidUpdate()

3. å¸è½½ç»„ä»¶

   - componentWillUnmount()

```javascript
// å³å°†åºŸå¼ƒçš„é’©å­
1.componentWillMount
2.componentWillReceiveProps
3.componentWillUpdate
// åœ¨æ–°çš„ç‰ˆæœ¬ä¸­éœ€è¦åŠ ä¸Š UNSAFE_ å‰ç¼€æ‰èƒ½ä½¿ç”¨ï¼Œå¯èƒ½ä»¥åä¼šåºŸå¼ƒ
// UNSAFEä¸æ˜¯æŒ‡å®‰å…¨æ€§ï¼Œè€Œæ˜¯è¡¨ç¤ºè¿™äº›ç”Ÿå‘½å‘¨æœŸçš„ä»£ç åœ¨React çš„æœªæ¥ç‰ˆæœ¬ä¸­æ›´æœ‰å¯èƒ½å‡ºç°bugï¼Œå°¤å…¶åœ¨å¼€å¯å¼‚æ­¥æ¸²æŸ“å
```

#### keyçš„ä½œç”¨

1. keyæ˜¯è™šæ‹ŸDOMå¯¹è±¡çš„æ ‡è¯†ï¼Œåœ¨æ›´æ–°æ˜¾ç¤ºæ—¶keyèµ·ç€æå…¶é‡è¦çš„ä½œç”¨

2. è¯¦ç»†çš„è¯´: å½“çŠ¶æ€ä¸­æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œreactä¼šæ ¹æ® æ–°æ•°æ® ç”Ÿæˆ æ–°çš„è™šæ‹ŸDOM

   â€‹                  éšåReact è¿›è¡Œ æ–°è™šæ‹ŸDOM ä¸ æ—§è™šæ‹ŸDOM diffæ¯”è¾ƒï¼Œæ¯”è¾ƒè§„åˆ™å¦‚ä¸‹

   - æ—§è™šæ‹ŸDOMä¸­æ‰¾åˆ°äº†ä¸æ–°è™šæ‹ŸDOMç›¸åŒçš„key
     - è‹¥è™šæ‹ŸDOMä¸­å†…å®¹æ²¡å˜ï¼Œç›´æ¥ä½¿ç”¨ä¹‹å‰çš„çœŸå®çš„DOM
     - è‹¥è™šæ‹ŸDOMä¸­å†…å®¹å˜äº†ï¼Œåˆ™ç”Ÿæˆæ–°çš„çœŸå®DOMï¼Œéšåæ›¿æ¢é¡µé¢ä¸­ä¹‹å‰çœŸå®DOM
   - æ—§è™šæ‹ŸDOMä¸­æœªæ‰¾åˆ°ä¸æ–°è™šæ‹ŸDOMç›¸åŒçš„key
     - æ ¹æ®æ•°æ®åˆ›å»ºæ–°çš„çœŸå®DOMï¼Œéšåæ¸²æŸ“åˆ°é¡µé¢

#### ç”¨indexå¯èƒ½å¼•å‘çš„é—®é¢˜

1. å¯¹æ•°æ®è¿›è¡Œï¼š é€†åºæ·»åŠ ï¼Œé€†åºåˆ é™¤ç­‰ç ´åæ“ä½œ

   > ä¼šäº§ç”Ÿæ²¡æœ‰å¿…è¦çš„çœŸå®DOMæ›´æ–°  ==ã€‹ ç•Œé¢æ•ˆæœæ²¡é—®é¢˜ï¼Œä½†æ•ˆç‡ä½

2. å¦‚æœç»“æ„ä¸­è¿˜åŒ…å«è¾“å…¥ç±»çš„DOM

   > ä¼šäº§ç”Ÿé”™è¯¯çš„DOMæ›´æ–° ==ã€‹ ç•Œé¢æœ‰é—®é¢˜

3. æ³¨æ„ï¼Œå¦‚æœåªæ˜¯ç”¨æ¥å±•ç¤ºæ“ä½œï¼Œç”¨`index`ä½œä¸ºkeyå€¼æ˜¯æ²¡æœ‰é—®é¢˜çš„



## æ‰©å±•

#### srcæ–‡ä»¶å¤¹ä»‹ç»

- public

  ```javascript
  index.html // ä¸»é¡µé¢
  manifest.json // åº”ç”¨åŠ å£³æ–‡ä»¶
  robots.txt // çˆ¬è™«åè®®æ–‡ä»¶
  ```

- src

  ```javascript
  App.js // Appç»„ä»¶
  index.js // å…¥å£æ–‡ä»¶
  App.text.js // ç”¨äºç»™Appåšæµ‹è¯•
  reprotWebVitals.js // é¡µé¢æ€§èƒ½åˆ†ææ–‡ä»¶ï¼ˆéœ€web-vitalsåº“çš„æ”¯æŒï¼‰
  setupTests.js // ç»„ä»¶å•å…ƒæµ‹è¯•çš„æ–‡ä»¶ï¼ˆéœ€è¦jest-domåº“çš„æ”¯æŒï¼‰
  ```


#### é…ç½®ä»£ç†æ–¹å¼

1. æ–¹æ³•ä¸€

   > åœ¨package.jsonä¸­è¿½åŠ å¦‚ä¸‹é…ç½®

   ```json
   {
       "proxy": "http://loclhost:5000"
   }
   ```

   > è¯´æ˜

   - ä¼˜ç‚¹ï¼š é…ç½®ç®€å•ï¼Œå‰ç«¯è¯·æ±‚èµ„æºå¯ä»¥ä¸åŠ ä»»ä½•å‰ç¼€
   - ç¼ºç‚¹ï¼š ä¸èƒ½é…ç½®å¤šä¸ªä»£ç†
   - å·¥ä½œæ–¹å¼ï¼š ä¸Šè¯‰æ–¹å¼é…ç½®ä»£ç†ï¼Œå½“è¯·æ±‚äº†3000ä¸å­˜åœ¨çš„èµ„æºæ—¶ï¼Œé‚£ä¹ˆè¯¥è¯·æ±‚ä¼šè½¬å‘ç»™5000ï¼ˆä¼˜å…ˆåŒ¹é…å‰ç«¯èµ„æºï¼‰

2. æ–¹æ³•äºŒ

   - åˆ›å»ºä»£ç†æ–‡ä»¶

     åœ¨srcä¸‹åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š `src/setupProxy.js`

   - ç¼–å†™setupProxy.jsé…ç½®å…·ä½“ä»£ç†è§„åˆ™

     ```javascript
     const proxy = require('http-proxy-middleware')
     
     module.exports = function(app) {
         app.use(
         	proxy('/api1',{ //api1æ˜¯éœ€è¦è½¬å‘çš„è¯·æ±‚ï¼ˆæ‰€æœ‰ï¼‰
                 target: 'http://localhost: 5000', // é…ç½®è½¬å‘ç›®æ ‡åœ°å€
                 changeOrigin: true, //æ§åˆ¶æœåŠ¡å™¨æ¥æ”¶åˆ°çš„è¯·æ±‚å¤´ä¸­hostå­—æ®µçš„å€¼
                 /*
              	changeOriginè®¾ç½®ä¸ºtrueæ—¶ï¼ŒæœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚å¤´ä¸­çš„hostä¸ºï¼šlocalhost:5000
              	changeOriginè®¾ç½®ä¸ºfalseæ—¶ï¼ŒæœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚å¤´ä¸­çš„hostä¸ºï¼šlocalhost:3000
              	changeOriginé»˜è®¤å€¼ä¸ºfalseï¼Œä½†æˆ‘ä»¬ä¸€èˆ¬å°†changeOriginå€¼è®¾ä¸ºtrue
              	*/
                 pathRewrite: {'^/api1': ''} // å»é™¤è¯·æ±‚å‰ç¼€ï¼Œä¿è¯äº¤ç»™åå°æœåŠ¡å™¨çš„æ˜¯æ­£å¸¸è¯·æ±‚åœ°å€ï¼ˆå¿…é¡»é…ç½®ï¼‰
             })ï¼Œ
             proxy('/api2',{
             	target: 'http://localhost:5001',
             	changeOrigin: true,
             	pathRewrite: {'^/api2': ''}
             })
         )
     }
     ```

   > è¯´æ˜

   - ä¼˜ç‚¹ï¼š å¯ä»¥é…ç½®å¤šä¸ªä»£ç†ï¼Œå¯ä»¥çµæ´»çš„æ§åˆ¶è¯·æ±‚æ˜¯å¦èµ°ä»£ç†
   - ç¼ºç‚¹ï¼š é…ç½®ç¹çï¼Œå‰ç«¯è¯·æ±‚èµ„æºæ—¶å¿…é¡»åŠ å‰ç¼€

#### æ¶ˆæ¯è®¢é˜…å‘å¸ƒ

- å·¥å…·åº“ï¼šPubSubJS

- ä¸‹è½½ï¼šnpm install pubsub-js --save

- ä½¿ç”¨

  ```javascript
  import PubSub from 'pubsub-js' // å¼•å…¥
  this.token = PubSub.subscribe('delete',function(data){}) // è®¢é˜…
  PubSub.publish('delete',data) // å‘å¸ƒæ¶ˆæ¯
  
  componentWillUnmount() {
      PubSub.unsubscribe(this.token) // å–æ¶ˆè®¢é˜…
  }
  ```

#### Fetch

- **æ¦‚å¿µ**

  - å…³æ³¨åˆ†ç¦»

    `XMLHttpRequest`é…ç½®ä¸è°ƒç”¨æ–¹å¼æ··ä¹±

  - å¼‚æ­¥æ¨¡å‹

    `Promise`     `generator/yield`   `async/awiat`

- **API**

  - getè¯·æ±‚

    ```javascript
    fetch(url).then(function(response){
        return response.json()
    }).then(function(data){
        console.log(data)
    }).catch(function(e){
        console.log(e)
    })
    ```

  - postè¯·æ±‚

    ```javascript
    fetch(url, {
        method: 'post',
        body:JSON.stringify(data)
    }).then(function(data){
        console.log(data)
    }).catch(function(e){
        console.log(e)
    })
    ```

  - fetchå‘é€ï¼ˆä¼˜åŒ–ï¼‰

    ```javascript
    try{
    	const response = await fetch(url)
    	const data = await response.json()
    } catch (error){
    	console.log('è¯·æ±‚å‡ºé”™', error)
    }
    ```

## Reactè·¯ç”±

#### SPAçš„ç†è§£

- å•é¡µWebåº”ç”¨ï¼ˆsingle page web application, SPAï¼‰
- æ•´ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªå®Œæ•´çš„é¡µé¢
- ç‚¹å‡»é¡µé¢ä¸­çš„é“¾æ¥ä¸ä¼šåˆ·æ–°é¡µé¢ï¼Œåªä¼šåšé¡µé¢çš„å±€éƒ¨æ›´æ–°
- æ•°æ®éƒ½éœ€è¦é€šè¿‡ajaxè¯·æ±‚è·å–ï¼Œå¹¶åœ¨å‰ç«¯å¼‚æ­¥å±•ç°

#### react-router-domçš„ç†è§£

- reactçš„ä¸€ä¸ªæ’ä»¶åº“
- ä¸“é—¨ç”¨æ¥å®ç°ä¸€ä¸ªSPAåº”ç”¨
- åŸºäºreactçš„é¡¹ç›®åŸºæœ¬éƒ½ä¼šç”¨åˆ°æ­¤åº“

#### react-route-domç›¸å…³API

- å†…ç½®ç»„ä»¶

  1. `<BrowserRouter>`

  2. `<HashRouter>`

  3. `<Route>`

  4. `<Redirect>`

  5. `<Link>`

  6. `<NavLink>`

     è·¯ç”±ç‚¹å‡»çš„é«˜äº®ï¼Œé€šè¿‡activeClassNameæŒ‡å®šæ ·å¼

  7. `<Switch>`

- è·¯ç”±çš„åŸºæœ¬ä½¿ç”¨

  > åŸºæœ¬ç•Œé¢

  ```javascript
  // ç¼–å†™è·¯ç”±é“¾æ¥  
  <Link className="list-group-item" to="/about">About</Link>
  <Link className="list-group-item" to="/home">Home</Link>
  
  // æ³¨å†Œè·¯ç”±
  <Route path="/about" component={About}/>
  <Route path="/home" component={Home}/>
  ```
  
  > ä¸»é¡µé¢
  
  ```javascript
  ReactDOM.render(
  	<BrowserRouter>
      	<APP/>
      </BrowserRouter>,
      document.getElementById('root')
  )
  ```
  
- è·¯ç”±ç»„ä»¶å’Œæ™®é€šç»„ä»¶åŒºåˆ«

  - å†™æ³•ä¸åŒ

    ä¸€èˆ¬ç»„ä»¶ï¼š `<Demo/>`

    è·¯ç”±ç»„ä»¶ï¼š`<Route path="/demo"  component={Demo}/>`

  - å­˜æ”¾ä½ç½®ä¸åŒ

    ä¸€èˆ¬ç»„ä»¶ï¼š`components`

    è·¯ç”±ç»„ä»¶ï¼š`pages`

  - æ¥æ”¶åˆ°çš„propsä¸åŒ

    ä¸€èˆ¬ç»„ä»¶ï¼šå†™ç»„ä»¶æ ‡ç­¾æ—¶ä¼ é€’äº†ä»€ä¹ˆï¼Œå°±èƒ½æ”¶åˆ°ä»€ä¹ˆ

    è·¯ç”±ç»„ä»¶ï¼š æ¥æ”¶åˆ°ä¸‰ä¸ªå›ºå®šçš„å±æ€§

    ```javascript
    history:
            go: f go(n)
            goBack: f goBack()
            goForward: f goForward()
            push: f push(path, state)
            replace: f replace(path, state)
    location: 
            pathname: "/about"
            search: ""
            state: undefined
    match:
            params: {}
            path: "/about"
            url: "/about"
    ```

#### æ ‡ç­¾ä½“å†…å®¹children

- é€šè¿‡this.porps.children å¯ä»¥è·å–æ ‡ç­¾ä½“å†…å®¹

#### è§£å†³è·¯ç”±åˆ·æ–°æ ·å¼ä¸¢å¤±é—®é¢˜

- public/index.html ä¸­å¼•å…¥æ ·å¼æ—¶ï¼Œä¸å†™ `./`, å†™ `/`  å¸¸ç”¨
- public/index.html ä¸­å¼•å…¥æ ·å¼æ—¶ï¼Œä¸å†™`./`, å†™`%PUBLIC_URL%`
- ä½¿ç”¨`HashRouter`

## å‚è€ƒ

- [React ä¸­æ–‡æ–‡æ¡£](https://zh-hans.reactjs.org/docs/getting-started.html)
- [Redux ä¸­æ–‡æ–‡æ¡£](http://cn.redux.js.org/)
- [React Router å®˜ç½‘](https://reactrouter.com/web/guides/quick-start) è‹±æ–‡ç‰ˆ
- [React é«˜é˜¶ç»„ä»¶(HOC)çš„å…¥é—¨ ğŸ“– åŠå®è·µ ğŸ’»](https://juejin.cn/post/6844904050236850184)
- [react-redux çš„ç®€å•ä½¿ç”¨](https://zhuanlan.zhihu.com/p/62417038)
- [react è·¯ç”±ä¼ å‚åŠå…¶åŒºåˆ«](https://segmentfault.com/a/1190000023554534)
- [å­¦ä¹ ç¬”è®°1](https://docs.qq.com/doc/DSG1jdUJtQ3FYR1V1)
- [å­¦ä¹ ç¬”è®°2](https://docs.qq.com/doc/DSGhGZk9PUm1KVldv)
